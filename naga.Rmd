---
title: "The Associations Between Mismanaged Plastic Waste and Per Capita GDP and Coastal Populations"
author: "Nagaprasad Rudrapatna"
date: "December 16, 2022"
output:
  pdf_document:
    number_sections: yes
header-includes:
- \usepackage{float}
- \floatplacement{figure}{H}
---

```{r setup, include = FALSE}
library(tidyverse)
library(naniar)
library(UpSetR)
library(betareg)
library(janitor)
library(broom)
library(knitr)
opts_chunk$set(echo = FALSE, include = FALSE, warning = FALSE, message = FALSE)
```

```{r}
coast_vs_waste <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-05-21/coastal-population-vs-mismanaged-plastic.csv") %>%
  select(-`Mismanaged plastic waste (tonnes)`) %>%
  filter(Year == '2010') %>%
  filter(Entity != "World")

mismanaged_vs_gdp <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-05-21/per-capita-mismanaged-plastic-waste-vs-gdp-per-capita.csv") %>%
  filter(Year == '2010')

waste_vs_gdp <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-05-21/per-capita-plastic-waste-vs-gdp-per-capita.csv") %>%
  select(Entity, Code, Year, `Per capita plastic waste (kilograms per person per day)`, `Total population (Gapminder)`) %>%
  filter(Year == '2010')

exclude <- c("Arab World", "Caribbean small states", "Central Europe and the Baltics", "Early-demographic dividend", "East Asia & Pacific", "East Asia & Pacific (IDA & IBRD)", "East Asia & Pacific (excluding high income)", "Europe and Central Asia", "Europe and Central Asia (IDA & IBRD)", "Europe and Central Asia (excluding high income)", "European Union", "Fragile and conflict affected situations", "Heavily indebted poor countries (IPC)", "High income", "IBRD only", "IDA and IBRD total", "IDA blend", "IDA only", "IDA total", "Late-demographic dividend", "Latin America & Caribbean", "Latin America & Caribbean (IDA & IBRD)", "Latin America & Caribbean (excluding high income)", "Least developed countries: UN classification", "Low & middle income", "Low income", "Lower middle income", "Middle East & North Africa", "Middle East & North Africa (IDA & IBRD)", "Middle East & North Africa (excluding high income)", "Middle income", "OECD members", "Other small states", "Pacific island small states", "Post-demographic dividend", "Pre-demographic dividend", "Small states", "South Asia", "South Asia (IDA & IBRD)", "Sub-Saharan Africa", "Sub-Saharan Africa (IDA & IBRD)", "Sub-Saharan Africa (excluding high income)", "Upper middle income", "World", "Euro area", "Europe & Central Asia", "Europe & Central Asia (IDA & IBRD)", "Europe & Central Asia (excluding high income)", "Heavily indebted poor countries (HIPC)", "IDA & IBRD total", "North America", "Kosovo", "Timor")

plastic <- left_join(mismanaged_vs_gdp, waste_vs_gdp, by = c('Entity', 'Code', 'Year', 'Total population (Gapminder)')) %>%
  filter(!(Entity %in% exclude))

plastic <- plastic %>%
  mutate(`Coastal Population` = coast_vs_waste$`Coastal population`) %>%
  rename("Country" = "Entity",
         "Total Population" = "Total population (Gapminder)",
         "Per Capita GDP" = "GDP per capita, PPP (constant 2011 international $) (Rate)",
         "Per Capita Mismanaged Waste (Per Day)" = "Per capita mismanaged plastic waste (kilograms per person per day)",
         "Per Capita Waste (Per Day)" = "Per capita plastic waste (kilograms per person per day)") %>%
  select(-Code)
```

```{r}
vis_miss(plastic, warn_large_data = F)
gg_miss_upset(plastic)
```

```{r}
plastic2 <- plastic %>%
  filter(!is.na(`Total Population`)) %>% # 11 excluded
  filter(!is.na(`Per Capita GDP`)) %>% # 38 excluded
  filter(!is.na(`Per Capita Mismanaged Waste (Per Day)`) & !is.na(`Per Capita Waste (Per Day)`)) %>% # 40 excluded
  mutate(`Mismanaged Waste Proportion` = `Per Capita Mismanaged Waste (Per Day)` / `Per Capita Waste (Per Day)`) %>%
  mutate(`Coastal Population Proportion` = ifelse(`Coastal Population` / `Total Population` < 1, `Coastal Population` / `Total Population`, 1)) %>% # when coastal population > total population, we consider the entire population to be coastal (islands)
  select(Country, `Per Capita GDP`, `Coastal Population Proportion`, `Coastal Population`, `Total Population`, `Mismanaged Waste Proportion`)
```

# Introduction

## Background Information

Plastic pollution is a severe and growing issue, adversely affecting ecosystems and wildlife across the globe. Plastic debris can negatively affect wildlife through three main pathways--entanglement, ingestion, and interaction (Law, 2017). Entanglement refers to the “entrapping, encircling, or constricting of marine animals by plastic debris” (e.g., plastic rope and netting, abandoned fishing gear) and cases have been reported for “all marine turtle species, more than two-thirds of seal species, one-third of whale species, and one-quarter of seabirds” (as well as numerous species of fish and invertebrates; Kühn, Bravo Rebolledo, & van Franeker, 2015). Ingestion of plastic can occur “unintentionally, intentionally, or indirectly through the ingestion of prey species containing plastic” and cases have been reported for “all marine turtle species, more than one-third of seal species, 59% of whale species, and 59% of seabirds” (as well as numerous species of fish and invertebrates; Ritchie & Roser, 2018; Kühn, Bravo Rebolledo, & van Franeker, 2015). Ingesting large volumes of plastic, for example, can “greatly reduce stomach capacity, leading to poor appetite and false sense of satiation”; plastic can also “obstruct or perforate the gut, cause ulcerative lesions, or gastric rupture” in these organisms (Ritchie & Roser, 2018). Plastic can also interact with ecosystem structures, impacting “light penetration, organic matter availability, and oxygen exchange” (Ritchie & Roser, 2018).


According to Geyer and collaborators (2017), the world produced only two million tonnes of plastic in 1950. Since then, annual global plastic production has increased roughly 150-fold, reaching 313 million tonnes in 2010 (this upward trend has continued since 2010: approximately 460 million tonnes in 2019; Ritchie & Roser, 2018). Naturally, as plastic production has amplified across several decades, the amount of generated plastic waste has also increased. Increased plastic waste, by itself, is not the primary issue. The main problem is rooted in the prevalence of poor waste management infrastructure in low-to-middle income countries (Ritchie & Roser, 2018). This has contributed to an increase in the amount of mismanaged plastic waste--plastic that is either inadequately disposed (stored in open or insecure landfills; high risk of polluting rivers and the ocean) or littered by coastal populations (defined as populations living within 50 kilometers of a coastline)--generated globally (Ritchie & Roser, 2018).  Plastic pollution in the ocean originates from both land-based and marine (“pollution caused by fishing fleets that leave behind fishing nets, lines, ropes, and sometimes abandoned vessels”) sources; the latest estimates indicate that roughly 80% of ocean plastics originate from land-based sources while the remaining 20% stems from marine sources (Li, Tse, & Fok, 2016). The activities of coastal populations are critical since the plastic waste generated by these groups is at a higher risk of leading to ocean debris (compared to sources further inland), but mismanaged waste can “eventually enter the ocean via inland waterways, wastewater outflows, and transport by wind or tides” (Ritchie & Roser, 2018). Previous research has shown that not all mismanaged plastic waste has the same probability of reaching the ocean. These studies have identified an area’s climate, terrain, land use, and proximity to river basins as key factors in determining the probability that mismanaged waste is emitted to the ocean (Ritchie & Roser, 2018).


It is important to emphasize that plastic waste can only enter rivers and the ocean if it is improperly managed. In fact, the vast majority of plastic waste ends up in landfills; approximately 3% of global plastic waste enters the ocean (Jambeck et al., 2015). Almost all plastic waste is “incinerated, recycled, or sent it to well-managed landfills” in wealthy countries, but “waste can be dumped outside of landfills (and the landfills that do exist are often open) in poorer countries, leaking waste to the surrounding environment” (Ritchie & Roser, 2018). Prior studies have suggested an association between the wealth of a country and its waste management infrastructure. A statistically rigorous analysis of this relationship, namely how a country’s wealth is associated with its mismanaged plastic waste (particularly, the proportion of total plastic waste that is mismanaged), could be useful for stakeholders (perhaps supranational organizations, such as the European Union or World Bank, who are interested in mitigating the effects of plastic pollution).



## Research Aims

A common measure of a country’s wealth is its gross domestic product (GDP), which is a comprehensive measure of the country’s economy and growth (in this analysis, GDP is calculated without making deductions for the depreciation of fabricated assets or for the depletion and degradation of natural resources). GDP per capita is GDP converted to international dollars (an international dollar has the same purchasing power over GDP as a US dollar has in the United States) using purchasing power parity (PPP) rates and divided by a country’s total population. In this analysis, PPP GDP per capita is considered in constant 2011 international dollars (Mock, 2019). This project, first and foremost, aims to address the following research question: how is a country's PPP GDP per capita associated with its proportion of mismanaged plastic waste (out of its total plastic waste)? The literature also suggests that waste generated by coastal populations is at a higher risk of entering the ocean. This project therefore seeks to also identify the association (if any) between the relative size of a country’s coastal population (the ratio of the coastal population to the total population) and its proportion of mismanaged plastic waste.


## Data Description and Key Variables

- give units for variables


Variable description

Daily plastic waste generation per person, measured in kilograms per
person per day (used to create response). This measures the overall per capita plastic waste generation rate prior to waste management, recycling or incineration. It does not therefore directly indicate the risk of pollution to waterways or marine
Environments.


The original dataset for this report described adult patients who received cardiac catheterization procedures at the Duke University Hospital between 1985 and 2013. Cardiac catheterization is a medical procedure that involves inserting a thin tube into the patient’s heart for either interventional or diagnostic purposes. This raw dataset included exactly one record per procedure, for a total of 83,320 procedures and 39,098 patients. Out of these patients, 21,492 are categorized as smokers, which is our target for our analysis.

## Hypotheses

Hypothesis
Therefore, there is much more mismanaged plastic waste in poorer countries than in their wealthier counterparts. 


## Exploratory Data Analysis

```{r include = T, fig.width = 4.5, fig.height = 3, fig.cap = "The Relationship Between PPP GDP Per Capita and Mismanaged Plastic Waste Proportion"}
ggplot(data = plastic2, mapping = aes(x = `Per Capita GDP`, y = `Mismanaged Waste Proportion`)) +
  geom_point() +
  labs(x = "PPP GDP Per Capita", y = "Proportion of Mismanaged Plastic Waste", title = "Response vs. PPP GDP Per Capita")
```

```{r include = T, fig.width = 4.5, fig.height = 3, fig.cap = "The Relationship Between PPP GDP Per Capita and Mismanaged Plastic Waste Proportion (after log-transformation)"}
ggplot(data = plastic2, mapping = aes(x = `Per Capita GDP`, y = log(`Mismanaged Waste Proportion`))) +
  geom_point() + # negative trend after log-transformation 
  labs(x = "PPP GDP Per Capita", y = "Log(Proportion of Mismanaged Plastic Waste)", title = "Log(Response) vs. PPP GDP Per Capita")
```

```{r}
ggplot(data = plastic2, mapping = aes(x = `Coastal Population`, y = `Mismanaged Waste Proportion`)) +
  geom_point()

ggplot(data = plastic2, mapping = aes(x = `Total Population`, y = `Mismanaged Waste Proportion`)) +
  geom_point()

ggplot(data = plastic2, mapping = aes(x = `Coastal Population Proportion`, y = `Mismanaged Waste Proportion`)) +
  geom_point() # no relationship
```

```{r}
# Asia dominates
plastic2 %>%
  arrange(desc(`Mismanaged Waste Proportion`)) %>%
  slice(1:5) %>%
  select(Country, `Mismanaged Waste Proportion`)
```


strong regional dominance in global mismanaged coastal waste in Asia (especially India)

# Methodology

Questions
- model -> EDA plots suggest log-transformation of response but then beta regression no longer suitable
- so, should I do beta regression or linear regression on the log-transformed proportions?
- what about coastal population proportion: seemingly no relationship -> can I still consider it as a covariate of interest?
- missing data approach: missing completely at random, complete case analysis

conduct a complete case analysis (first exclude non-countries, then exclude countries without full information - Kosovo, Timor (island; East Timor - sovereign, West Timor part of Indonesia) excluded for lack of population data)
- response variable is created from mismanaged and total plastic waste
- per capita GDP (based on 2011 international rates) and proportion of country's coastal population to total population (reported by Gapminder) are covariates of interest

-> only consider 2010 since that's when plastic waste data is available
-> create response variable: Per Capita Mismanaged Waste (Per Day) / Per Capita Waste (Per Day)
-> create second covariate: Coastal Population / Total Population

-> tried to manually adjust total population for countries whose coastal population > total population, but found that the issue persisted for some countries
- issues with data collection of coastal population (how is it collected?)

response variable: between [0, 1]
beta regression! - not a GLM

- logit link
- Y ~ Beta(Alpha, Beta)
- logit(E(Y|X)) = X' beta
- log(Alpha / Beta) = X' beta
- Y = ratio of mismanaged to total plastic waste
- no error term

- interpretations: linear predictor of logit of conditional expectation
- why use logit link? - interpretability
- interactions -> no because interpreting quantitative-quantitative interactions is difficult, not aligned with objective

- assumptions for beta regression? - independence (only 2010 -> satisfied), linearity of predictors

Using mathematical notation, we can express our final model as

```{=tex}
\begin{align*}
\log(T_i) &= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{3i} +  \beta_4 x_{4i} + \beta_5 x_{5i} + \beta_6 x_{6i}  + \beta_7 x_{7i} + \beta_8 x_{8i} + \ldots + \beta_{30} x_{30i} + \epsilon_i
\end{align*}
```

where $i$ is the index for the patient (ranging from 1 to 21,180), $T_i$ is the predicted survival time of $i$th patient with a history of smoking. In terms of the covariates, $x_{1i}$ through $x_{3i}$ indicate the $i$th patient’s body mass index category, $x_{4i}$ through $x_{7i}$ indicate the $i$th patient’s congestive heart failure severity, and $x_{8i}$ through $x_{30i}$ are the controlled patient demographic and medical factors.

# Results

The regression coefficients were estimated using the `betareg()` function in R. Table 2 displays the coefficient estimates, as well as the corresponding 95% confidence intervals and p-values for the final model.

```{r}
bm1 <- betareg(`Mismanaged Waste Proportion` ~ `Per Capita GDP`, data = plastic2)

bm2 <- betareg(`Mismanaged Waste Proportion` ~ `Per Capita GDP` + `Coastal Population Proportion`, data = plastic2)

lm1 <- lm(log(`Mismanaged Waste Proportion`) ~ `Per Capita GDP`, data = plastic2)

lm2 <- lm(log(`Mismanaged Waste Proportion`) ~ `Per Capita GDP` + `Coastal Population Proportion`, data = plastic2)

summary(bm1)
summary(bm2)
summary(lm1)
summary(lm2)
```

```{r include = T}
final_output <- clean_names(as.data.frame(summary(bm2)[["coefficients"]][["mean"]])) %>%
  mutate(conf_int_lower = (estimate - (1.96*std_error)),
         conf_int_upper = (estimate + (1.96*std_error))) %>%
  select(estimate, conf_int_lower, conf_int_upper, pr_z) %>%
  mutate(p = if_else(pr_z < 0.01, 0.00, pr_z),
         p = ceiling(p * 10000) / 10000,
         p = as.character(p),
         p = if_else(p == "0", "<0.01", p)) %>%
  rename("Coefficient" = estimate,
         "Lower Bound" = conf_int_lower,
         "Upper Bound" = conf_int_upper,
         "P-Value" = p) %>%
  select(-pr_z)

final_output %>%
  kable(digits = 3, caption = "Final Model Coefficients and 95% Confidence Intervals")
```

Holding the proportion of a country's total population that lives within 50 kilometers of a coastline constant:

# Discussion

## Conclusions

## Limitations and Future Directions

## Summary

# Appendices

# References

1) Law, K. L. (2017). Plastics in the marine environment. Annual review of marine science, 9, 205-229. 

2) Kühn, S., Bravo Rebolledo, E.L., van Franeker, J.A. (2015). Deleterious Effects of Litter on Marine Life. In: Bergmann, M., Gutow, L., Klages, M. (eds) Marine Anthropogenic Litter. Springer, Cham. https://doi.org/10.1007/978-3-319-16510-3_4

3) Hannah Ritchie and Max Roser (2018) - "Plastic Pollution". Published online at OurWorldInData.org. Retrieved from: 'https://ourworldindata.org/plastic-pollution' [Online Resource]

4) Geyer et al., 2017: Production, use, and fate of all plastics ever made | Science Advances

5) W.C. LI, H.F. TSE, L. FOK, Plastic waste in the marine environment: A review of sources, occurrence and effects, Science of The Total Environment, Volumes 566–567, 2016, Pages 333-349, ISSN 0048-9697, https://doi.org/10.1016/j.scitotenv.2016.05.084.

6) Jambeck et al., 2015 Plastic waste inputs from land into the ocean | Science

7) Thomas Mock (2019). Tidy Tuesday: A weekly data project aimed at the R ecosystem. https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-05-21.

